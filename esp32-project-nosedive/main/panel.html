<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<script>
	var entries = [
		{
			cmd: 'pcaset',
			values: ['all,50','0,50','1,50','2,50','3,50','4,50','5,50','6,50','7,50','8,50','9,50','10,50','11,50','12,50','13,50','14,50','15,50'],
			iter: 0,
		},
		{
			cmd: 'pcamax',
			values: ['all', '0', '1', '2', '3', '4', '5', '6', '7', '8', '9', '10', '11', '12', '13', '14', '15'],
			iter: 0,
		},
		{
			cmd: 'pcaoff',
			values: ['all', '0', '1', '2', '3', '4', '5', '6', '7', '8', '9', '10', '11', '12', '13', '14', '15'],
			iter: 0,
		},
		{
			cmd: 'pcafreq',
			values: ['25', '50', '100', '250', '500', '750', '1000', '1250', '1500'],
			iter: 0,
		},
		{
			cmd: 'restart',
			values: [''],
			iter: 0,
		},
	]
	function send_act(entry, input) {
		var dest = document.getElementById('request').value
		const value = document.getElementById(input).value
		dest += '?' + entries[entry].cmd + '=' + value
		fetch(dest, {mode: 'no-cors'})
	}
	function save_act(index) {
		const dest = document.getElementById(index).value
		localStorage.setItem(index, dest)
	}
	function del_field(id) {
		document.getElementById(id).remove()
	}
	function add_field(id, value) {
		var field = document.createElement('span')
		field.id = '' + id + '-' + entries[id].iter
		field.style.display = 'inline-block' // Input and button elements are as one block.
		field.style.margin = '0.15em'
		entries[id].iter += 1
		var input = document.createElement('input')
		input.id = field.id + '-data'
		input.style.width = '6em'
		input.value = value
		field.appendChild(input)
		var send_button = document.createElement('button')
		send_button.setAttribute('onclick', 'send_act(' + id + ', "' + input.id + '")')
		send_button.innerHTML = '⬆️'
		field.appendChild(send_button)
		var trash_button = document.createElement('button')
		trash_button.setAttribute('onclick', 'del_field("' + field.id + '")')
		trash_button.innerHTML = '❎'
		field.appendChild(trash_button)
		document.getElementById(id).appendChild(field)
	}
	window.onload = function() {
		var table = document.createElement('table')
		document.body.appendChild(table)
		for (let i = 0; i < entries.length; ++i) {
			var row = document.createElement('tr')
			var label_cell = document.createElement('td')
			label_cell.innerHTML = entries[i].cmd
			row.appendChild(label_cell)
			var button_cell = document.createElement('td')
			var button = document.createElement('button')
			button.setAttribute('onclick', 'add_field(' + i + ', "")')
			button.innerHTML = '➕'
			button_cell.appendChild(button)
			row.appendChild(button_cell)
			var list = document.createElement('td')
			list.id = i
			list.style.padding = '0.1em'
			row.appendChild(list)
			table.appendChild(row)
			for (let j = 0; j < entries[i].values.length; ++j) {
				add_field(i, entries[i].values[j])
			}
		}
	}
</script>
</head>
<body>
	REQUEST = <input id="request" value="http://192.168.4.1:333/set"><br>
</body>
</html>
